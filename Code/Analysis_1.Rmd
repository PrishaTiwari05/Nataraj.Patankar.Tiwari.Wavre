---
title: "Analysis_1"
author: "Nataraj.Patankar.Tiwari.Wavre"
date: "2025-04-16"
output: pdf_document
---

## Number of EVs vs Number of Charging Stations

In this part of our analysis, we explore  

```{r analysis 1 part 1}
#Loading Packages
```

## Number of EVs vs Average income of States

In this part of our analysis, we explore whether the average income of a state is correlated to the number of electric vehicles sold in that state. To do so, we will start by cleaning our data, conducting a correlation test, and then creating a correlation plot. 

```{r analysis 1 part 2}
#Loading Packages 
library(dplyr)
library(tidyverse)
library(here)
library(ggplot2)
library(corrplot)
library(readxl)
library(stringr)

here()

#Cleaning Data
EV_Data_PT <- read_excel("Data/Raw/2016-2023 LDV Registration Data.xlsx")
Income_Data_PT <- read.csv("Data/Raw/Average Income Data by State.csv")
Income_Clean <- Income_Data_PT %>%
  mutate(State = str_trim(str_remove(State, "\\*")))

EV_vs_Income <- full_join(EV_Data_PT, Income_Clean, by = "State", "Year")
colnames(EV_vs_Income) [c(3,4,15,16)] <- c("EV", "PHEV", "Year","Avg_Income")

EV_vs_Inc_clean <- EV_vs_Income %>%
  select(Year, EV, PHEV, State, Avg_Income)

#Correlation test
EV.test <- cor.test(EV_vs_Inc_clean$EV, EV_vs_Inc_clean$Avg_Income)
EV.test

PHEV.test <- cor.test(EV_vs_Inc_clean$PHEV, EV_vs_Inc_clean$Avg_Income)
PHEV.test
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
