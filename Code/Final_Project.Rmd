---
title: "Factors Affecting EV Adoption in the U.S."
author: "Nataraj.Patankar.Tiwari.Wavre"
date: "2025-04-24"
output: html_document
editor_options: 
  chunk_output_type: console
---

## Introduction


## Background and Motivation 


## Information on Datasets


## Setting up the Session
```{r setup, message=FALSE, warning=FALSE, results='hide'}
#Installing and loading packages
#install.packages("ggforce")
#install.packages("readxl")
library(tidyverse)
library(lubridate)
library(here)
library(ggplot2)
library(stringr)
library(cowplot)
library(ggforce)
library(scales)
library(dplyr)
library(readxl)
library(sf)
library(leaflet)
library(mapview); mapviewOptions(fgb = FALSE)
```

## Importing and Cleaning Datasets


```{r datasets, message=FALSE, warning=FALSE}
#EV Registration Data
LDV_Data <- read_excel("Data/Raw/2016-2023 LDV Registration Data.xlsx")
colnames(LDV_Data) [c(3,4)] <- c("EV", "PHEV")
LDV_Clean <- LDV_Data %>%
  mutate(Total_EV = EV + PHEV) %>%
  select(Year, State, Total_EV, EV, PHEV)

#Income Data
Income_Data <- read.csv("Data/Raw/Average Income Data by State.csv")
Income_Clean <- Income_Data %>%
  mutate(State = str_trim(str_remove(State, "\\*")))

#write.csv(Income_Clean, "Data/Processed/Avg_Income_Clean.csv", row.names = FALSE)

#Population Data
Pop_Data <- read_excel("Data/Raw/Population 2020-2024.xlsx")
colnames(Pop_Data) [c(2,3,4,5)] <- c("Pop_2020","Pop_2021","Pop_2022","Pop_2023")

Pop_clean <- Pop_Data %>%
  pivot_longer(cols = starts_with("Pop_"), names_to = "Year", names_prefix = "Pop_", values_to = "Population") %>%
  select(Year, State, Population) %>%
  mutate(Year = as.numeric(Year))

#write.csv(Pop_clean, "Data/Processed/Population_Clean.csv", row.names = FALSE)

#Fuel Stations 
```

## Creating Data Plots
```{r}
# Creating GGPlot of Statewise Total EV Registrations
ggplot(LDV_Clean, aes(x = Year, y = `Total_EV`, color = State)) +
  geom_line(size = 1) +
  labs(
    title = "Total EV Registrations by State (2016â€“2023)",
    x = "Year",
    y = "Number of EVs Registered",
    color = "State"
  ) +
  theme_minimal(base_size = 14)

```

